define(["jquery"],function(jQuery){var popinDefaultId="PopinMail",popinSelector=[],showNotification=function(msgSent,popinId){var popinId=popinId===undefined?popinDefaultId:popinId,$popin=jQuery("#"+popinId);if($popin){var hideSelector=msgSent?"[data-share-form-error]":"[data-share-form-success]";showSelector=msgSent?"[data-share-form-success]":"[data-share-form-error]";$popin.find("[data-share-form], [data-share-form-button]").hide();if(msgSent){var sharedWith=$popin.find("[data-share-form]").find("[ data-shared-with]").val();
$popin.find("[data-share-form-success]").find("[ data-shared-with]").text(sharedWith)}$popin.find(hideSelector).hide().end().find(showSelector+", [data-share-form-result-button]").show(0,function(){$("body").trigger("notification.shown")})}},showNotificationSuccess=function(popinId){showNotification(true,popinId)},showNotificationError=function(popinId){showNotification(false,popinId)},resetPopin=function(popinId){if(popinId instanceof jQuery)$popin=popinId;else var popinId="#"+popinId===undefined?
popinDefaultId:popinId,$popin=jQuery(popinId);showForm(true,$popin);$popin.find("[data-share-form-success]").find("[ data-shared-with]").text("")},showForm=function(shouldResetForm,popinId){if(popinId instanceof jQuery)$popin=popinId;else var popinId="#"+popinId===undefined?popinDefaultId:popinId,$popin=jQuery(popinId);shouldResetForm=shouldResetForm===undefined?true:shouldResetForm;if(shouldResetForm)resetForm($popin);if($popin)$popin.find("[data-share-form-success], [data-share-form-error], [data-share-form-result-button]").hide().end().find("[data-share-form], [data-share-form-button]").show()},
resetForm=function(popinId){if(popinId instanceof jQuery)$popin=popinId;else var popinId="#"+popinId===undefined?popinDefaultId:popinId,$popin=jQuery(popinId);if($popin)$popin.find(".help-block").remove().end().find(".has-error").removeClass("has-error").end().find("form").find("[data-shared-with]").val("")},init=function(popinIds){if(!popinIds instanceof Array)return false;else popinIds.forEach(function(el,index){popinSelector.push("#"+el)});popinSelector.forEach(function(selector,index){jQuery(document).on("hide.bs.modal",
selector,function(){var $thisPopin=jQuery(this);if($thisPopin.find("[data-share-form]").first().is(":hidden"))setTimeout(function($popin){resetPopin($popin)}.bind(this,$thisPopin),500)})})};return{showNotificationSuccess:showNotificationSuccess,showNotificationError:showNotificationError,init:init}});